{% extends "SesileMainBundle:Default:index.html.twig" %}

{% block content %}
    <div class="bloc_page">
        <div class="titre_page">
            <span class="glyphicon glyphicon-cog"></span>
            &nbsp;&nbsp;&nbsp;Ajouter une nouvelle collectivité
        </div>
        {{ form_start(form) }}
        <div class="row">
            <div class="col-md-3">{{ form_label(form.nom) }}</div>
            <div class="col-md-9">{{ form_widget(form.nom) }}</div>
        </div>
        <div class="row">
            <div class="col-md-3">{{ form_label(form.domain) }}</div>
            <div class="col-md-9">{{ form_widget(form.domain) }}</div>
        </div>
        <div class="row">
            <div class="col-md-3">{{ form_label(form.active) }}</div>
            <div class="col-md-9">{{ form_widget(form.active) }}</div>
        </div>
        <div class="row">
            <div class="col-md-3">{{ form_label(form.file) }}</div>
            <div class="col-md-9">{{ form_widget(form.file) }}</div>
        </div>
        <br>
        <ul class="nav nav-tabs">
            <li class="active"><a aria-expanded="true" href="#mail" data-toggle="tab">Mails</a></li>
            <li class=""><a aria-expanded="false" href="#visa" data-toggle="tab">Visa</a></li>
            <li class=""><a aria-expanded="false" href="#signature" data-toggle="tab">Signature</a></li>
        </ul>
        <div id="myTabContent" class="tab-content">
            <div class="tab-pane fade active in" id="mail">
                <br>
                {{ form_label(form.textmailnew) }}
                {{ form_widget(form.textmailnew) }}

                <br><br><br>

                <div class="row">
                    <div class="col-md-2"></div>
                    <img class="gradientawesome col-md-8" src="{{ asset("/images/bg-module-top-shadow.png") }}"/>
                    <div class="col-md-2"></div>
                </div>
                {{ form_label(form.textmailrefuse) }}
                {{ form_widget(form.textmailrefuse) }}
                <br><br><br>
                <div class="row">
                    <div class="col-md-2"></div>
                    <img class="gradientawesome col-md-8" src="{{ asset("/images/bg-module-top-shadow.png") }}"/>
                    <div class="col-md-2"></div>
                </div>
                {{ form_label(form.textmailwalid) }}
                {{ form_widget(form.textmailwalid) }}
                <br><br><br>

                <div class="row">
                    <div class="col-md-2"></div>
                    <img class="gradientawesome col-md-8" src="{{ asset("/images/bg-module-top-shadow.png") }}"/>
                    <div class="col-md-2"></div>
                </div>
                {{ form_label(form.message) }}
                {{ form_widget(form.message) }}
            </div>


            <!-- Visa -->
            <div class="tab-pane fade" id="visa">

                <div class="row row-padding">
                    <div class="col-md-12">
                        <label>Disposition du cartouche visa</label>
                    </div>
                </div>

                <div class="row">
                    <div class="col-md-6">
                        <div class="row row-padding">
                            <div class="col-md-3">
                                <label for="colorPicker">{{ form_label(form.couleurVisa) }}</label>
                            </div>
                            <div class="col-md-9">
                                {{ form_widget(form.couleurVisa) }}
                                <div class="bfh-colorpicker col-md-6" id="colorPicker" data-name="colorpicker1" data-color="{{ form.couleurVisa.vars.value }}"></div>
                            </div>
                        </div>
                        <div class="row row-padding">
                            <div class="col-md-3">{{ form_label(form.titreVisa) }}</div>
                            <div class="col-md-9">{{ form_widget(form.titreVisa, {'attr': {'class': 'col-md-6'} }) }}</div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="row row-padding">
                            <div class="col-md-12">
                                <label>Emplacement du visa</label>
                                <div id="containment"></div>
                                {# Input hidden #}
                                {{ form_widget(form.abscissesVisa) }}
                                {{ form_widget(form.ordonneesVisa) }}
                            </div>
                        </div>
                    </div>
                </div>

            </div>


            <!-- Signature -->
            <div class="tab-pane fade" id="signature">
                <div class="row row-padding">
                    <div class="col-md-12"><label>Disposition de la signature</label></div>
                </div>

                <div class="row row-padding">
                    <div class="col-md-6">
                        <div class="row row-padding">
                            <div class="col-md-3">{{ form_label(form.pageSignature) }}</div>
                            <div class="col-md-7">{{ form_widget(form.pageSignature, {'attr': {'class': 'col-md-12'} }) }}</div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="row row-padding">
                            <div class="col-md-12">
                                <label>Emplacement de la signature</label>
                                <div id="containmentSignature"></div>
                                {# Input hidden #}
                                {{ form_widget(form.abscissesSignature) }}
                                {{ form_widget(form.ordonneesSignature) }}
                            </div>
                        </div>
                    </div>

                </div>

            </div>
        </div>

        <div class="row">
            <div class="col-lg-3">
                {{ form_widget(form.submit, {'attr': {'class': 'btn btn-success' }}) }}
            </div>
            <div class="col-lg-4">
                <a href="{{ path('index_collectivite') }}" class="btn btn-primary navbar-btn">
                    <span class="glyphicon glyphicon-share-alt"></span>
                    Retour aux collectivités
                </a>
            </div>
        </div>


    {{ form_end(form) }}
    </div>

    <link rel="stylesheet" type="text/css" href="{{ asset("/bootstrap3-wysihtml5/src/bootstrap-wysihtml5.css") }}"/>
    <link rel="stylesheet" type="text/css" href="{{ asset("/bootstrap/css/bootstrap-formhelpers.min.css") }}"/>
    <script src="{{ asset("/bootstrap3-wysihtml5/lib/js/wysihtml5-0.3.0.js") }}" type="text/javascript"></script>
    <script src="{{ asset("/js/bootstrap-formhelpers.js") }}" type="text/javascript"></script>
    <script src="{{ asset("/bootstrap3-wysihtml5/src/bootstrap3-wysihtml5.js") }}" type="text/javascript"></script>
    <script src="{{ asset("/bootstrap3-wysihtml5/src/locales/bootstrap-wysihtml5.fr-FR.js") }}"></script>
    <script src="{{ asset("/js/drag.js") }}" type="text/javascript"></script>
    <script type="text/javascript">
        $('textarea').wysihtml5({
            "image": false,
            locale: "fr-FR"
        });
        $('#colorPicker').on('change.bfhcolorpicker',function(){
            $('#sesile_mainbundle_collectivite_couleurVisa').val($(this).val());
        });


        cVerticalPadding = 10;
        cHorizontalPadding = 10;

        $('#containment').drag('init',{
            cWidth:"210px",
            cHeight:"297px",
            cVerticalPadding:cVerticalPadding + "px",
            cHorizontalPadding:cHorizontalPadding + "px",
            dText: "VISA",
            posX:{{ form.abscissesVisa.vars.value }},
            posY:{{ form.ordonneesVisa.vars.value }}
        });

        $('#containmentSignature').drag('initSign',{
            cWidth:"210px",
            cHeight:"297px",
            dWidth:"75px",
            cVerticalPadding:cVerticalPadding + "px",
            cHorizontalPadding:cHorizontalPadding + "px",
            dText: "SIGNATURE",
            posX:{{ form.abscissesSignature.vars.value }},
            posY:{{ form.ordonneesSignature.vars.value }}
        });

        $("#containment .draggable").on('dragstop', function(event, ui) {

            $('#sesile_mainbundle_collectivite_abscissesVisa').val(ui.position.left + cHorizontalPadding);
            $('#sesile_mainbundle_collectivite_ordonneesVisa').val(ui.position.top + cVerticalPadding);

            /*$('#sesile_mainbundle_collectivite_abscissesVisa').val($('#container').drag('getPosX'));
             $('#sesile_mainbundle_collectivite_ordonneesVisa').val($('#container').drag('getPosY'));*/
        });

        $("#containmentSignature .draggable").on('dragstop', function(event, ui) {

            $('#sesile_mainbundle_collectivite_abscissesSignature').val(ui.position.left + cHorizontalPadding);
            $('#sesile_mainbundle_collectivite_ordonneesSignature').val(ui.position.top + cVerticalPadding);

        });

    </script>
{% endblock %}